if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0)from+=len;for(;from<len;from++){if(from in this&&this[from]===elt)return from;}return-1;};}function FavoriteHandler(){this.setCookie=function(name,value,seconds){if(typeof(seconds)!='undefined'){var date=new Date();date.setTime(date.getTime()+(seconds*1000));var expires="; expires="+date.toGMTString();}else{var expires="";}document.cookie=name+"="+value+expires+"; path=/";}
this.getCookie=function(name){name=name+"=";var carray=document.cookie.split(';');for(var i=0;i<carray.length;i++){var c=carray[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(name)==0)return unescape(c.substring(name.length,c.length));}return null;}
this.deleteCookie=function(name){this.setCookie(name,"",-1);}
this.toFavoriteLink=function(){if(typeof(this.getCookie('shkFavoriteIds'))!='string')this.setCookie('shkFavoriteIds','',365*60*60);var FavoriteIds=this.getCookie('shkFavoriteIds')!=null?this.getCookie('shkFavoriteIds'):'';var FavoriteIds_arr=FavoriteIds.length>0?FavoriteIds.split(','):new Array();if(FavoriteIds_arr.length<=1){if(typeof(cmpOnToFavoriteLinkMinimum)=='function')cmpOnToFavoriteLinkMinimum();else alert('Для сравнения необходимо выбрать минимум 2 товара.');return false;}else{return true;}}
this.toFavorite=function(id,parentid,elem){var FavoriteIds=this.getCookie('shkFavoriteIds')!=null?this.getCookie('shkFavoriteIds'):'';var FavoriteIds_arr=FavoriteIds.length>0?FavoriteIds.split(','):new Array();var FavoriteParentId=this.getCookie('shkFavoriteParent')!=null?this.getCookie('shkFavoriteParent'):parentid;var output_arr=new Array();if(elem.checked==true){if(fav_config.onlyThisParentId!=false&&FavoriteParentId!=parentid){if(typeof(favOnToFavoriteFromAnotherCategory)=='function'){var FavoriteConfirm=favOnToFavoriteFromAnotherCategory();}else{var FavoriteConfirm=confirm('Вы можете добавлять в избранное товары одной категории.  При добавлении данного товара в список старые данные будут удалены.');}if(FavoriteConfirm){this.setCookie('shkFavoriteIds',id,365*60*60);this.setCookie('shkFavoriteParent',parentid,365*60*60);window.location.reload();return true;}else{return false;}}if(fav_config.limitProducts>0&&FavoriteIds_arr.length==fav_config.limitProducts){if(typeof(favOnToFavoriteLimitReached)=='function')favOnToFavoriteLimitReached(fav_config.limitProducts);else alert('Вы можете выбрать '+fav_config.limitProducts+' позиции в избранное.');return false;}if(FavoriteIds_arr.indexOf(id.toString())>-1){return true;}output_arr=FavoriteIds_arr;output_arr.push(id.toString());$('a.tofav'+id).addClass('active');ShowWindow('Товар добавлен в избранное');}else{for(var i=0;i<FavoriteIds_arr.length;i++){if(FavoriteIds_arr[i]!=id)output_arr.push(FavoriteIds_arr[i]);}$('a.tofav'+id).removeClass('active');ShowWindow('Товар удален из избранного');}if(output_arr.length==0){this.deleteCookie('shkFavoriteIds');this.deleteCookie('shkFavoriteParent');}else{this.setCookie('shkFavoriteIds',output_arr.join(','),365*60*60);this.setCookie('shkFavoriteParent',parentid,365*60*60);}if(document.getElementById('favorite_countselect')!=null)document.getElementById('favorite_countselect').innerHTML=output_arr.length;if(document.getElementById('favorite_otmena')!=null){if(output_arr.length==0)document.getElementById('favorite_otmena').style.display='none';else document.getElementById('favorite_otmena').style.display='inline';}if(typeof(favOnToFavoriteCheckClicked)=='function')favOnToFavoriteCheckClicked(id,parentid,elem);return true;}}var shkFavorite=new FavoriteHandler();